# Commerce Platform - Backend Architecture Guide

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš”](#ê°œìš”)
2. [ì•„í‚¤í…ì²˜ ê°œìš”](#ì•„í‚¤í…ì²˜-ê°œìš”)
3. [í†µì‹  í”„ë¡œí† ì½œ](#í†µì‹ -í”„ë¡œí† ì½œ)
4. [ì„œë¹„ìŠ¤ êµ¬ì¡°](#ì„œë¹„ìŠ¤-êµ¬ì¡°)
5. [ë°ì´í„° íë¦„](#ë°ì´í„°-íë¦„)
6. [ì„¤ê³„ ì›ì¹™](#ì„¤ê³„-ì›ì¹™)

---

## ê°œìš”

ë³¸ ë¬¸ì„œëŠ” Commerce Platformì˜ Backend ì•„í‚¤í…ì²˜ì— ëŒ€í•œ ê°€ì´ë“œë¼ì¸ì„ ì œê³µí•©ë‹ˆë‹¤.
ìš°ë¦¬ ì‹œìŠ¤í…œì€ **MSA(Microservice Architecture)** ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆìœ¼ë©°, í™•ì¥ì„±ê³¼ ìœ ì—°ì„±ì„ ìµœìš°ì„ ìœ¼ë¡œ ê³ ë ¤í•©ë‹ˆë‹¤.

### ê¸°ìˆ  ìŠ¤íƒ ìš”ì•½

| êµ¬ë¶„ | ê¸°ìˆ  |
|------|------|
| ì•„í‚¤í…ì²˜ | MSA (Microservice Architecture) |
| Frontend â†” Backend | GraphQL |
| Backend â†” Backend (ë™ê¸°) | gRPC |
| Backend â†” Backend (ë¹„ë™ê¸°) | Apache Kafka |

---

## ì•„í‚¤í…ì²˜ ê°œìš”

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Client Layer                                â”‚
â”‚                    (Web, Mobile, Third-party Apps)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â”‚ HTTPS
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           API Gateway Layer                              â”‚
â”‚                         (GraphQL Federation)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                          GraphQL   â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Service Mesh Layer                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   User      â”‚   Product   â”‚   Order     â”‚   Payment   â”‚   Inventory    â”‚
â”‚   Service   â”‚   Service   â”‚   Service   â”‚   Service   â”‚   Service      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚                    gRPC (ë™ê¸° í†µì‹ ) / Kafka (ë¹„ë™ê¸° í†µì‹ )                  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           Data Layer                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  PostgreSQL â”‚    Redis    â”‚Elasticsearchâ”‚         S3/Storage           â”‚
â”‚   (RDBMS)   â”‚   (Cache)   â”‚  (Search)   â”‚          (Files)             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## í†µì‹  í”„ë¡œí† ì½œ

### 1. GraphQL (Frontend â†” Backend)

Frontendì™€ Backend ê°„ì˜ í†µì‹ ì€ **GraphQL**ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

#### ì„ íƒ ì´ìœ 

- **ìœ ì—°í•œ ë°ì´í„° ìš”ì²­**: í´ë¼ì´ì–¸íŠ¸ê°€ í•„ìš”í•œ ë°ì´í„°ë§Œ ì •í™•íˆ ìš”ì²­ ê°€ëŠ¥
- **ë‹¨ì¼ ì—”ë“œí¬ì¸íŠ¸**: í•˜ë‚˜ì˜ ì—”ë“œí¬ì¸íŠ¸ë¡œ ëª¨ë“  ë°ì´í„° ì ‘ê·¼
- **íƒ€ì… ì‹œìŠ¤í…œ**: ê°•ë ¥í•œ íƒ€ì… ì‹œìŠ¤í…œìœ¼ë¡œ API ê³„ì•½ ëª…í™•í™”
- **ì‹¤ì‹œê°„ ì§€ì›**: Subscriptionì„ í†µí•œ ì‹¤ì‹œê°„ ë°ì´í„° ì—…ë°ì´íŠ¸

#### êµ¬í˜„ ê°€ì´ë“œ

```graphql
# Schema ì˜ˆì‹œ
type Query {
  product(id: ID!): Product
  products(filter: ProductFilter, pagination: PaginationInput): ProductConnection!
  order(id: ID!): Order
}

type Mutation {
  createOrder(input: CreateOrderInput!): CreateOrderPayload!
  updateProduct(id: ID!, input: UpdateProductInput!): UpdateProductPayload!
}

type Subscription {
  orderStatusChanged(orderId: ID!): OrderStatusEvent!
}
```

#### ì„¤ê³„ ì›ì¹™

1. **Queryì™€ Mutation ë¶„ë¦¬**: ì½ê¸°ì™€ ì“°ê¸° ì‘ì—… ëª…í™•íˆ ë¶„ë¦¬
2. **Pagination í•„ìˆ˜**: ë¦¬ìŠ¤íŠ¸ ì¡°íšŒ ì‹œ ë°˜ë“œì‹œ í˜ì´ì§€ë„¤ì´ì…˜ ì ìš©
3. **ì—ëŸ¬ ì²˜ë¦¬ í‘œì¤€í™”**: GraphQL ì—ëŸ¬ ì‘ë‹µ í˜•ì‹ í†µì¼
4. **N+1 ë¬¸ì œ ë°©ì§€**: DataLoader íŒ¨í„´ ì ìš© í•„ìˆ˜

---

### 2. gRPC (Backend â†” Backend ë™ê¸° í†µì‹ )

ì„œë¹„ìŠ¤ ê°„ **ë™ê¸°ì ** í†µì‹ ì€ **gRPC**ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

#### ì„ íƒ ì´ìœ 

- **ê³ ì„±ëŠ¥**: HTTP/2 ê¸°ë°˜, Protocol Buffersë¡œ ë¹ ë¥¸ ì§ë ¬í™”
- **íƒ€ì… ì•ˆì „ì„±**: `.proto` íŒŒì¼ë¡œ ëª…í™•í•œ ì¸í„°í˜ì´ìŠ¤ ì •ì˜
- **ì–‘ë°©í–¥ ìŠ¤íŠ¸ë¦¬ë°**: ì‹¤ì‹œê°„ ë°ì´í„° ì „ì†¡ ì§€ì›
- **ì–¸ì–´ ì¤‘ë¦½ì **: ë‹¤ì–‘í•œ ì–¸ì–´ ê°„ í˜¸í™˜ì„±

#### ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

| ì‹œë‚˜ë¦¬ì˜¤ | ì„¤ëª… |
|----------|------|
| ì‚¬ìš©ì ì¸ì¦ í™•ì¸ | Order Service â†’ User Service |
| ìƒí’ˆ ì •ë³´ ì¡°íšŒ | Order Service â†’ Product Service |
| ì¬ê³  í™•ì¸ | Order Service â†’ Inventory Service |
| ê²°ì œ ì²˜ë¦¬ ìš”ì²­ | Order Service â†’ Payment Service |

#### Proto íŒŒì¼ êµ¬ì¡°

```
/protos
â”œâ”€â”€ common/
â”‚   â”œâ”€â”€ pagination.proto
â”‚   â””â”€â”€ error.proto
â”œâ”€â”€ user/
â”‚   â””â”€â”€ user_service.proto
â”œâ”€â”€ product/
â”‚   â””â”€â”€ product_service.proto
â”œâ”€â”€ order/
â”‚   â””â”€â”€ order_service.proto
â”œâ”€â”€ payment/
â”‚   â””â”€â”€ payment_service.proto
â””â”€â”€ inventory/
    â””â”€â”€ inventory_service.proto
```

#### Proto ì •ì˜ ì˜ˆì‹œ

```protobuf
// order_service.proto
syntax = "proto3";

package commerce.order;

import "common/pagination.proto";

service OrderService {
  // ë‹¨ì¼ ì£¼ë¬¸ ì¡°íšŒ
  rpc GetOrder(GetOrderRequest) returns (GetOrderResponse);
  
  // ì£¼ë¬¸ ëª©ë¡ ì¡°íšŒ
  rpc ListOrders(ListOrdersRequest) returns (ListOrdersResponse);
  
  // ì£¼ë¬¸ ìƒì„±
  rpc CreateOrder(CreateOrderRequest) returns (CreateOrderResponse);
  
  // ì£¼ë¬¸ ìƒíƒœ ì—…ë°ì´íŠ¸
  rpc UpdateOrderStatus(UpdateOrderStatusRequest) returns (UpdateOrderStatusResponse);
}

message GetOrderRequest {
  string order_id = 1;
}

message GetOrderResponse {
  Order order = 1;
}

message Order {
  string id = 1;
  string user_id = 2;
  repeated OrderItem items = 3;
  OrderStatus status = 4;
  int64 total_amount = 5;
  google.protobuf.Timestamp created_at = 6;
}

enum OrderStatus {
  ORDER_STATUS_UNSPECIFIED = 0;
  ORDER_STATUS_PENDING = 1;
  ORDER_STATUS_CONFIRMED = 2;
  ORDER_STATUS_SHIPPED = 3;
  ORDER_STATUS_DELIVERED = 4;
  ORDER_STATUS_CANCELLED = 5;
}
```

#### ì„¤ê³„ ì›ì¹™

1. **ë©±ë“±ì„± ë³´ì¥**: ê°€ëŠ¥í•œ ëª¨ë“  RPC ë©”ì„œë“œëŠ” ë©±ë“±ì„±ì„ ê°€ì§€ë„ë¡ ì„¤ê³„
2. **íƒ€ì„ì•„ì›ƒ ì„¤ì •**: ëª¨ë“  gRPC í˜¸ì¶œì— ì ì ˆí•œ íƒ€ì„ì•„ì›ƒ ì„¤ì • í•„ìˆ˜
3. **ì¬ì‹œë„ ì •ì±…**: Exponential backoff ê¸°ë°˜ ì¬ì‹œë„ ë¡œì§ êµ¬í˜„
4. **Circuit Breaker**: ì¥ì•  ì „íŒŒ ë°©ì§€ë¥¼ ìœ„í•œ ì„œí‚· ë¸Œë ˆì´ì»¤ íŒ¨í„´ ì ìš©

---

### 3. Kafka (Backend â†” Backend ë¹„ë™ê¸° í†µì‹ )

ë³µì¡í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ì´ë²¤íŠ¸ë‚˜ ì‹œê°„ì´ ì˜¤ë˜ ê±¸ë¦¬ëŠ” ì‘ì—…ì€ **Kafka**ë¥¼ í†µí•´ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬í•©ë‹ˆë‹¤.

#### ì„ íƒ ì´ìœ 

- **ë†’ì€ ì²˜ë¦¬ëŸ‰**: ëŒ€ìš©ëŸ‰ ë©”ì‹œì§€ ì²˜ë¦¬ì— ìµœì í™”
- **ë‚´êµ¬ì„±**: ë©”ì‹œì§€ ì˜ì†ì„± ë³´ì¥
- **í™•ì¥ì„±**: íŒŒí‹°ì…˜ì„ í†µí•œ ìˆ˜í‰ í™•ì¥
- **ì´ë²¤íŠ¸ ì†Œì‹±**: ì´ë²¤íŠ¸ íˆìŠ¤í† ë¦¬ ë³´ê´€ ë° ì¬ì²˜ë¦¬ ê°€ëŠ¥

#### ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤

| ì´ë²¤íŠ¸ | Producer | Consumer(s) |
|--------|----------|-------------|
| ì£¼ë¬¸ ìƒì„±ë¨ | Order Service | Inventory, Notification, Analytics |
| ê²°ì œ ì™„ë£Œë¨ | Payment Service | Order, Notification |
| ì¬ê³  ë³€ê²½ë¨ | Inventory Service | Product, Analytics |
| ë°°ì†¡ ìƒíƒœ ë³€ê²½ | Delivery Service | Order, Notification |

#### Topic ë„¤ì´ë° ì»¨ë²¤ì…˜

```
{domain}.{entity}.{event-type}

ì˜ˆì‹œ:
- order.order.created
- order.order.status-changed
- payment.payment.completed
- payment.payment.failed
- inventory.stock.updated
- user.user.registered
```

#### ë©”ì‹œì§€ ìŠ¤í‚¤ë§ˆ (Avro)

```json
{
  "type": "record",
  "name": "OrderCreatedEvent",
  "namespace": "com.commerce.order.events",
  "fields": [
    {"name": "event_id", "type": "string"},
    {"name": "event_type", "type": "string"},
    {"name": "timestamp", "type": "long"},
    {"name": "order_id", "type": "string"},
    {"name": "user_id", "type": "string"},
    {"name": "items", "type": {"type": "array", "items": {
      "type": "record",
      "name": "OrderItem",
      "fields": [
        {"name": "product_id", "type": "string"},
        {"name": "quantity", "type": "int"},
        {"name": "price", "type": "long"}
      ]
    }}},
    {"name": "total_amount", "type": "long"}
  ]
}
```

#### ì„¤ê³„ ì›ì¹™

1. **ì´ë²¤íŠ¸ ë²„ì „ ê´€ë¦¬**: ìŠ¤í‚¤ë§ˆ ì§„í™”ë¥¼ ìœ„í•œ ë²„ì „ ê´€ë¦¬ í•„ìˆ˜
2. **ë©±ë“± Consumer**: ConsumerëŠ” ì¤‘ë³µ ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„
3. **Dead Letter Queue**: ì²˜ë¦¬ ì‹¤íŒ¨ ë©”ì‹œì§€ë¥¼ ìœ„í•œ DLQ êµ¬ì„±
4. **íŒŒí‹°ì…”ë‹ ì „ëµ**: ìˆœì„œ ë³´ì¥ì´ í•„ìš”í•œ ê²½ìš° ì ì ˆí•œ íŒŒí‹°ì…˜ í‚¤ ì„¤ì •

---

## ì„œë¹„ìŠ¤ êµ¬ì¡°

### í•µì‹¬ ë„ë©”ì¸ ì„œë¹„ìŠ¤

| ì„œë¹„ìŠ¤ | ì±…ì„ | ì£¼ìš” ë°ì´í„° |
|--------|------|-------------|
| **User Service** | ì‚¬ìš©ì ê´€ë¦¬, ì¸ì¦/ì¸ê°€ | User, Address, Auth Token |
| **Product Service** | ìƒí’ˆ ê´€ë¦¬, ì¹´íƒˆë¡œê·¸ | Product, Category, Brand |
| **Order Service** | ì£¼ë¬¸ ì²˜ë¦¬, ì£¼ë¬¸ ìƒíƒœ ê´€ë¦¬ | Order, OrderItem |
| **Payment Service** | ê²°ì œ ì²˜ë¦¬, í™˜ë¶ˆ | Payment, Refund |
| **Inventory Service** | ì¬ê³  ê´€ë¦¬ | Stock, Warehouse |
| **Notification Service** | ì•Œë¦¼ ë°œì†¡ | Notification Template |
| **Search Service** | ê²€ìƒ‰, í•„í„°ë§ | Search Index |
| **Analytics Service** | ë°ì´í„° ë¶„ì„, ë¦¬í¬íŒ… | Event Log |

### ì„œë¹„ìŠ¤ ê²½ê³„ ì›ì¹™

1. **Single Responsibility**: ê° ì„œë¹„ìŠ¤ëŠ” í•˜ë‚˜ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë„ë©”ì¸ë§Œ ë‹´ë‹¹
2. **Data Ownership**: ì„œë¹„ìŠ¤ëŠ” ìì‹ ì˜ ë°ì´í„°ë¥¼ ë…ì ì ìœ¼ë¡œ ì†Œìœ 
3. **API First**: ì„œë¹„ìŠ¤ ê°„ ì§ì ‘ DB ì ‘ê·¼ ê¸ˆì§€, APIë¥¼ í†µí•´ì„œë§Œ í†µì‹ 
4. **Loose Coupling**: ì„œë¹„ìŠ¤ ê°„ ì˜ì¡´ì„± ìµœì†Œí™”

---

## ë°ì´í„° íë¦„

### ì£¼ë¬¸ ìƒì„± íë¦„ ì˜ˆì‹œ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      GraphQL       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ API Gateway â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â–¼
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚Order Service â”‚
                               â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                       â”‚                       â”‚
         gRPC â”‚                  gRPC â”‚                  gRPC â”‚
              â–¼                       â–¼                       â–¼
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚User Service â”‚      â”‚Product Service  â”‚      â”‚Inventory Serviceâ”‚
       â”‚(ì¸ì¦ í™•ì¸)   â”‚      â”‚(ìƒí’ˆ ì •ë³´ ì¡°íšŒ)  â”‚      â”‚(ì¬ê³  í™•ì¸/ì°¨ê°) â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
                                      â”‚ ì£¼ë¬¸ ìƒì„± ì™„ë£Œ
                                      â–¼
                               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                               â”‚    Kafka     â”‚
                               â”‚ order.createdâ”‚
                               â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                            â”‚                            â”‚
         â–¼                            â–¼                            â–¼
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚Payment Serviceâ”‚          â”‚Notification    â”‚          â”‚Analytics     â”‚
  â”‚(ê²°ì œ ì²˜ë¦¬)     â”‚          â”‚Service(ì•Œë¦¼)   â”‚          â”‚Service(ê¸°ë¡) â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ì„¤ê³„ ì›ì¹™

### 1. í†µì‹  ë°©ì‹ ì„ íƒ ê¸°ì¤€

| ê¸°ì¤€ | gRPC (ë™ê¸°) | Kafka (ë¹„ë™ê¸°) |
|------|-------------|----------------|
| ì‘ë‹µ í•„ìš” ì—¬ë¶€ | ì¦‰ì‹œ ì‘ë‹µ í•„ìš” | ì‘ë‹µ ë¶ˆí•„ìš” |
| ì²˜ë¦¬ ì‹œê°„ | ì§§ìŒ (< 1ì´ˆ) | ê¹€ (> 1ì´ˆ) |
| ì‹¤íŒ¨ ì‹œ ì²˜ë¦¬ | ì¦‰ì‹œ ì—ëŸ¬ ë°˜í™˜ | ì¬ì‹œë„/DLQ |
| ë°ì´í„° ì •í•©ì„± | ê°•í•œ ì¼ê´€ì„± í•„ìš” | ìµœì¢… ì¼ê´€ì„± í—ˆìš© |

### 2. ì—ëŸ¬ ì²˜ë¦¬ ì „ëµ

#### gRPC ì—ëŸ¬ ì½”ë“œ ë§¤í•‘

| ë¹„ì¦ˆë‹ˆìŠ¤ ì—ëŸ¬ | gRPC Status Code |
|--------------|------------------|
| ë¦¬ì†ŒìŠ¤ ì—†ìŒ | NOT_FOUND |
| ì¸ì¦ ì‹¤íŒ¨ | UNAUTHENTICATED |
| ê¶Œí•œ ì—†ìŒ | PERMISSION_DENIED |
| ì˜ëª»ëœ ìš”ì²­ | INVALID_ARGUMENT |
| ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ìœ„ë°˜ | FAILED_PRECONDITION |
| ì„œë²„ ì—ëŸ¬ | INTERNAL |

#### Kafka ì—ëŸ¬ ì²˜ë¦¬

1. **ì¬ì‹œë„ ê°€ëŠ¥ ì—ëŸ¬**: ì§€ì •ëœ íšŸìˆ˜ë§Œí¼ ì¬ì‹œë„
2. **ì¬ì‹œë„ ë¶ˆê°€ ì—ëŸ¬**: Dead Letter Queueë¡œ ì´ë™
3. **ëª¨ë‹ˆí„°ë§**: DLQ ë©”ì‹œì§€ ì•Œë¦¼ ì„¤ì •

### 3. íŠ¸ëœì­ì…˜ ê´€ë¦¬

#### Saga íŒ¨í„´ ì ìš©

ë³µìˆ˜ ì„œë¹„ìŠ¤ì— ê±¸ì¹œ íŠ¸ëœì­ì…˜ì€ **Saga íŒ¨í„´**ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.

```
ì£¼ë¬¸ ìƒì„± Saga:
1. Order Service: ì£¼ë¬¸ ìƒì„± (PENDING)
2. Inventory Service: ì¬ê³  ì˜ˆì•½
3. Payment Service: ê²°ì œ ì²˜ë¦¬
4. Order Service: ì£¼ë¬¸ í™•ì • (CONFIRMED)

ë³´ìƒ íŠ¸ëœì­ì…˜ (ì‹¤íŒ¨ ì‹œ):
- Payment ì‹¤íŒ¨ â†’ Inventory ì˜ˆì•½ ì·¨ì†Œ â†’ Order ì·¨ì†Œ
```

### 4. ë³´ì•ˆ

- **Service-to-Service ì¸ì¦**: mTLS ì ìš©
- **API Gateway**: JWT í† í° ê²€ì¦
- **Rate Limiting**: ì„œë¹„ìŠ¤ë³„ ìš”ì²­ ì œí•œ
- **ì…ë ¥ ê²€ì¦**: ëª¨ë“  ì…ë ¥ ë°ì´í„° ê²€ì¦ í•„ìˆ˜

---

## ì°¸ê³  ìë£Œ

- [gRPC Documentation](https://grpc.io/docs/)
- [GraphQL Specification](https://spec.graphql.org/)
- [Apache Kafka Documentation](https://kafka.apache.org/documentation/)
- [Microservices Patterns](https://microservices.io/patterns/)

---

> ğŸ“… **ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-12-03  
> âœï¸ **ì‘ì„±ì**: Backend Team

